import 'dotenv/config';
import { google } from 'googleapis';

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Google API
const auth = new google.auth.JWT(
  process.env.GOOGLE_SERVICE_EMAIL,
  null,
  process.env.GOOGLE_PRIVATE_KEY?.replace(/\\n/g, '\n'),
  ['https://www.googleapis.com/auth/spreadsheets']
);

const sheets = google.sheets({ version: 'v4', auth });
const SHEET_ID = process.env.GOOGLE_VACANCIES_SHEET_ID || process.env.GOOGLE_SHEET_ID;

async function updateVacanciesWithRequirements() {
  try {
    console.log('üìù –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–π —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞–º–∏...');
    
    // –î–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (A:I - 9 –∫–æ–ª–æ–Ω–æ–∫)
    const vacancyData = [
      // –ó–∞–≥–æ–ª–æ–≤–∫–∏
      ['–ù–∞–∑–≤–∞–Ω–∏–µ', '–û–ø–∏—Å–∞–Ω–∏–µ', '–≠–º–æ–¥–∑–∏', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è', '–°—Å—ã–ª–∫–∞', '–£—Ä–æ–≤–µ–Ω—å', '–ó–∞—Ä–ø–ª–∞—Ç–∞', '–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è', '–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞'],
      
      // –í–∞–∫–∞–Ω—Å–∏–∏
      [
        'Frontend Developer',
        '–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –Ω–∞ React, Vue, JavaScript',
        'üíª',
        'IT/–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞',
        'https://example.com/frontend',
        'Middle',
        '150-200k',
        '–û–ø—ã—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç 2 –ª–µ—Ç\n–ó–Ω–∞–Ω–∏–µ React/Vue\n–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å Git\n–ü–æ–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ –û–û–ü',
        '–£–¥–∞–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞\n–ì–∏–±–∫–∏–π –≥—Ä–∞—Ñ–∏–∫\n–û–±—É—á–µ–Ω–∏–µ –∏ —Ä–∞–∑–≤–∏—Ç–∏–µ\n–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏'
      ],
      [
        'Backend Developer',
        '–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —á–∞—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ Node.js, Python',
        '‚öôÔ∏è',
        'IT/–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞',
        'https://example.com/backend',
        'Middle',
        '150-200k',
        '–û–ø—ã—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç 2 –ª–µ—Ç\n–ó–Ω–∞–Ω–∏–µ Node.js/Python\n–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö\n–ü–æ–Ω–∏–º–∞–Ω–∏–µ REST API',
        '–£–¥–∞–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞\n–ì–∏–±–∫–∏–π –≥—Ä–∞—Ñ–∏–∫\n–û–±—É—á–µ–Ω–∏–µ –∏ —Ä–∞–∑–≤–∏—Ç–∏–µ\n–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã'
      ],
      [
        'UI/UX Designer',
        '–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–ø—ã—Ç–∞',
        'üé®',
        '–î–∏–∑–∞–π–Ω',
        'https://example.com/designer',
        'Middle',
        '120-180k',
        '–ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ —Ä–∞–±–æ—Ç\n–ó–Ω–∞–Ω–∏–µ Figma, Adobe XD\n–ü–æ–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ UX/UI\n–ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å',
        '–ö—Ä–µ–∞—Ç–∏–≤–Ω–∞—è —Å—Ä–µ–¥–∞\n–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã\n–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–æ—Å—Ç–∞\n–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã'
      ],
      [
        'Product Manager',
        '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–æ–º, –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ä–∞–±–æ—Ç–∞ —Å –∫–æ–º–∞–Ω–¥–æ–π',
        'üìà',
        '–ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç',
        'https://example.com/pm',
        'Senior',
        '200-300k',
        '–û–ø—ã—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–æ–º –æ—Ç 3 –ª–µ—Ç\n–ù–∞–≤—ã–∫–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏\n–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å Agile/Scrum\n–õ–∏–¥–µ—Ä—Å–∫–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞',
        '–í—ã—Å–æ–∫–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å\n–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–ª–∏—è—Ç—å –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç\n–†–∞–±–æ—Ç–∞ —Å –∫–æ–º–∞–Ω–¥–æ–π\n–ö–∞—Ä—å–µ—Ä–Ω—ã–π —Ä–æ—Å—Ç'
      ],
      [
        'Marketing Manager',
        '–†–∞–∑–≤–∏—Ç–∏–µ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π, —Ä–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º',
        'üì¢',
        '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥',
        'https://example.com/marketing',
        'Middle',
        '100-150k',
        '–û–ø—ã—Ç –≤ digital-–º–∞—Ä–∫–µ—Ç–∏–Ω–≥–µ –æ—Ç 2 –ª–µ—Ç\n–ó–Ω–∞–Ω–∏–µ SMM –∏ –∫–æ–Ω—Ç–µ–Ω—Ç-–º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞\n–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π\n–ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å',
        '–ö—Ä–µ–∞—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞\n–†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏\n–†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏\n–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤'
      ],
      [
        'QA Engineer',
        '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è',
        'üß™',
        'QA/–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ',
        'https://example.com/qa',
        'Junior',
        '80-120k',
        '–û–ø—ã—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç 1 –≥–æ–¥–∞\n–ó–Ω–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–π —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è\n–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å –±–∞–≥-—Ç—Ä–µ–∫–µ—Ä–∞–º–∏\n–í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –¥–µ—Ç–∞–ª—è–º',
        '–î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞\n–ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ\n–†–∞–±–æ—Ç–∞ —Å –Ω–æ–≤—ã–º–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏\n–í–∞–∂–Ω–∞—è —Ä–æ–ª—å –≤ –ø—Ä–æ–µ–∫—Ç–µ'
      ]
    ];
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ Google Sheets
    await sheets.spreadsheets.values.update({
      spreadsheetId: SHEET_ID,
      range: 'Sheet1!A1:I7', // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω A1:I7 (–∑–∞–≥–æ–ª–æ–≤–æ–∫ + 6 –≤–∞–∫–∞–Ω—Å–∏–π)
      valueInputOption: 'RAW',
      resource: {
        values: vacancyData
      }
    });
    
    console.log('‚úÖ –í–∞–∫–∞–Ω—Å–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞–º–∏');
    console.log('üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã:');
    console.log('   A - –ù–∞–∑–≤–∞–Ω–∏–µ');
    console.log('   B - –û–ø–∏—Å–∞–Ω–∏–µ');
    console.log('   C - –≠–º–æ–¥–∑–∏');
    console.log('   D - –ö–∞—Ç–µ–≥–æ—Ä–∏—è');
    console.log('   E - –°—Å—ã–ª–∫–∞');
    console.log('   F - –£—Ä–æ–≤–µ–Ω—å');
    console.log('   G - –ó–∞—Ä–ø–ª–∞—Ç–∞');
    console.log('   H - –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è (—á–µ—Ä–µ–∑ \\n)');
    console.log('   I - –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ (—á–µ—Ä–µ–∑ \\n)');
    
  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–∞–∫–∞–Ω—Å–∏–π:', error);
  }
}

// –ó–∞–ø—É—Å–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
updateVacanciesWithRequirements();
